/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2016 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/Control','sap/ui/core/delegate/ItemNavigation'],function(q,C,I){"use strict";var S=C.extend("sap.ui.demokit.SimpleTree",{metadata:{library:"sap.ui.demokit",properties:{title:{type:"string",defaultValue:null},width:{type:"sap.ui.core.CSSSize",defaultValue:'auto'},height:{type:"sap.ui.core.CSSSize",defaultValue:'auto'},showFilter:{type:"boolean",defaultValue:true}},defaultAggregation:"nodes",aggregations:{nodes:{type:"sap.ui.demokit.SimpleTreeNode",multiple:true,singularName:"node",bindable:"bindable"},_searchField:{type:"sap.m.SearchField",multiple:false,visibility:"hidden"}}}});S.prototype.init=function(){this._initializeSearchField();this._createNodesFocusHandling();};S.prototype.expandAll=function(){var c=this.getNodes();for(var i=0;i<c.length;i++){c[i].expand(true);}};S.prototype.collapseAll=function(){var c=this.getNodes();for(var i=0;i<c.length;i++){c[i].collapse(true);}};S.prototype.isTreeBinding=function(n){return(n=="nodes");};S.prototype.onAfterRendering=function(){this._initializeNodesFocusHandling();};S.prototype.exit=function(){this._destroyNodesFocusHandling();};S.prototype._initializeSearchField=function(){var t=this;var s=this.getAggregation("_searchField");s=new sap.m.SearchField({selectOnFocus:false,showSearchButton:false,liveChange:function(e){_.call(t,e.getParameter("newValue"));}});s.addStyleClass("sapDkSimpleTreeSearchField");this.setAggregation("_searchField",s,true);function _(f){var F=[];var n=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,f);F.push(n);var b=this.getBinding("nodes");b.filter(F);this.expandAll();}};S.prototype._createNodesFocusHandling=function(){this._itemNavigation=new I();this._itemNavigation.setCycling(false);this.addEventDelegate(this._itemNavigation);};S.prototype._initializeNodesFocusHandling=function(){this._itemNavigation.setRootDomRef(this.$().children("ul")[0]);this._itemNavigation.setItemDomRefs(this._getDomRefs());};S.prototype._destroyNodesFocusHandling=function(){if(this._itemNavigation){this._itemNavigation.destroy();}};S.prototype._getDomRefs=function(){var d=[];var n=this.getNodes();for(var i=0;i<n.length;i++){n[i]._getDomRefs(d);}return d;};return S;});
